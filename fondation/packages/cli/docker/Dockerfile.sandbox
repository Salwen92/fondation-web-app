# Claude CLI Sandbox Image
FROM node:18-alpine

# Install essential tools
RUN apk add --no-cache \
    bash \
    coreutils \
    findutils \
    grep \
    sed \
    jq \
    git \
    curl \
    && rm -rf /var/cache/apk/*

# Create non-root user
RUN addgroup -g 1000 claude && \
    adduser -u 1000 -G claude -D -s /bin/bash claude

# Create workspace directory
RUN mkdir -p /workspace /tmp && \
    chown -R claude:claude /workspace /tmp

# Switch to non-root user
USER claude
WORKDIR /workspace

# Set safe environment
ENV NODE_ENV=production \
    PATH=/usr/local/bin:/usr/bin:/bin \
    HOME=/tmp

# Default command
CMD ["/bin/bash"]