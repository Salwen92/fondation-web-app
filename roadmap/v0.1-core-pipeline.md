# Version 0.1: Core Pipeline
**Duration**: 2 weeks  
**Goal**: Minimal viable pipeline from login to job creation  
**Bundle Size Target**: <200KB

## Package Installation

### Week 1, Day 1: Project Setup
```bash
# Create Next.js project
npx create-next-app@latest fondation-web --typescript --tailwind --app

# Core dependencies only
npm install convex@^1.0.0
npm install next-auth@5.0.0-beta.25
npm install zod@3.24.2

# Minimal UI setup
npx shadcn-ui@latest init
# Choose: New York, Slate, CSS Variables
npx shadcn-ui@latest add button card avatar dropdown-menu toast
```

### Week 1, Day 2-3: Essential packages
```bash
# Authentication & forms
npm install react-hook-form@^7.54.2 @hookform/resolvers@^4.1.3
npm install bcryptjs@^3.0.2

# UI utilities (minimal)
npm install clsx@^2.1.1 tailwind-merge@^3.0.2
npm install lucide-react@^0.483.0
npm install sonner@^2.0.3

# Development only
npm install -D @types/bcryptjs
```

## Phase 1.1: Foundation & Authentication (Days 1-3)

### User Story
"As a developer, I want to sign in with my GitHub account so the application can access my repositories."

### Implementation Steps

#### 1. Project Structure
```
src/
├── app/
│   ├── (auth)/
│   │   ├── login/
│   │   │   └── page.tsx
│   │   └── layout.tsx
│   ├── (dashboard)/
│   │   ├── layout.tsx
│   │   └── page.tsx
│   ├── api/
│   │   └── auth/
│   │       └── [...nextauth]/
│   │           └── route.ts
│   └── layout.tsx
├── components/
│   ├── ui/           # Shadcn components
│   └── auth/
│       ├── login-button.tsx
│       └── user-menu.tsx
├── lib/
│   ├── auth.ts
│   └── utils.ts
└── convex/
    ├── schema.ts
    └── users.ts
```

#### 2. Convex Schema (Minimal)
```typescript
// convex/schema.ts
import { defineSchema, defineTable } from "convex/server";
import { v } from "convex/values";

export default defineSchema({
  users: defineTable({
    githubId: v.string(),
    username: v.string(),
    email: v.optional(v.string()),
    avatarUrl: v.optional(v.string()),
    createdAt: v.number(),
  }).index("by_github_id", ["githubId"]),
});
```

#### 3. NextAuth Configuration
```typescript
// lib/auth.ts
import NextAuth from "next-auth";
import GitHub from "next-auth/providers/github";

export const { handlers, auth, signIn, signOut } = NextAuth({
  providers: [
    GitHub({
      clientId: process.env.GITHUB_CLIENT_ID,
      clientSecret: process.env.GITHUB_CLIENT_SECRET,
      authorization: {
        params: {
          scope: "read:user user:email repo",
        },
      },
    }),
  ],
  callbacks: {
    async session({ session, token }) {
      // Minimal session data
      return session;
    },
  },
});
```

### UI Components (Minimal)

#### Login Page
```typescript
// app/(auth)/login/page.tsx
import { Button } from "@/components/ui/button";
import { Card } from "@/components/ui/card";
import { Github } from "lucide-react";

export default function LoginPage() {
  return (
    <div className="flex min-h-screen items-center justify-center">
      <Card className="w-full max-w-md p-8">
        <h1 className="text-2xl font-bold mb-6">Welcome to Fondation</h1>
        <Button className="w-full" size="lg">
          <Github className="mr-2 h-5 w-5" />
          Sign in with GitHub
        </Button>
      </Card>
    </div>
  );
}
```

### Acceptance Criteria
- [ ] GitHub OAuth flow completes successfully
- [ ] User document created in Convex
- [ ] Session persists on refresh
- [ ] Basic error handling with toast notifications

## Phase 1.2: Repository Listing (Days 4-6)

### Additional Packages (Day 4)
```bash
# Only what we need for repos
npm install @octokit/rest@^21.1.1
npm install uuid@^11.1.0
```

### Implementation

#### 1. Extend Convex Schema
```typescript
// convex/schema.ts - additions
repositories: defineTable({
  userId: v.id("users"),
  githubRepoId: v.string(),
  name: v.string(),
  fullName: v.string(),
  description: v.optional(v.string()),
  defaultBranch: v.string(),
}).index("by_user", ["userId"]),

jobs: defineTable({
  userId: v.id("users"),
  repositoryId: v.id("repositories"),
  status: v.union(
    v.literal("pending"),
    v.literal("running"),
    v.literal("completed"),
    v.literal("failed")
  ),
  prompt: v.string(),
  callbackToken: v.string(),
  createdAt: v.number(),
}).index("by_user", ["userId"]),
```

#### 2. Repository List Component
```typescript
// components/repos/repo-card.tsx
import { Card } from "@/components/ui/card";
import { Button } from "@/components/ui/button";

export function RepoCard({ repo, onGenerate }) {
  return (
    <Card className="p-4">
      <h3 className="font-semibold">{repo.name}</h3>
      <p className="text-sm text-muted-foreground">{repo.description}</p>
      <Button 
        onClick={() => onGenerate(repo.id)}
        className="mt-4"
        size="sm"
      >
        Generate Docs
      </Button>
    </Card>
  );
}
```

### Acceptance Criteria
- [ ] Fetch repos from GitHub API
- [ ] Display in simple grid layout
- [ ] Create job with "pending" status
- [ ] Show success toast

## Phase 1.3: Cloud Run Setup (Days 7-10)

### Container Configuration
```dockerfile
# Minimal Dockerfile
FROM node:20-alpine
WORKDIR /app
COPY dist/cli.bundled.cjs .
COPY prompts ./prompts
RUN npm install express@^4.18.0
COPY server.js .
EXPOSE 8080
CMD ["node", "server.js"]
```

### Minimal Server
```javascript
// server.js - Bare minimum
const express = require('express');
const app = express();

app.use(express.json());

app.post('/execute', (req, res) => {
  const { jobId, callbackUrl, callbackToken } = req.body;
  
  // Mock execution for v0.1
  setTimeout(() => {
    fetch(callbackUrl, {
      method: 'POST',
      headers: {
        'X-Job-Token': callbackToken,
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        jobId,
        type: 'complete',
        exitCode: 0,
      }),
    });
  }, 5000);
  
  res.json({ status: 'started', jobId });
});

app.listen(8080);
```

## Testing Checklist

### Performance
- [ ] Bundle size <200KB
- [ ] Lighthouse score >80
- [ ] Time to Interactive <2s
- [ ] No layout shifts

### Functionality
- [ ] Login flow works
- [ ] Repositories load
- [ ] Job creation succeeds
- [ ] Basic error states handled

## Deployment

### Environment Variables
```env
# Minimal for v0.1
NEXT_PUBLIC_CONVEX_URL=
CONVEX_DEPLOY_KEY=
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=
NEXTAUTH_SECRET=
NEXTAUTH_URL=
CLOUD_RUN_URL=
CLOUD_RUN_TOKEN=
```

### Deployment Commands
```bash
# Convex
npx convex deploy

# Vercel
vercel --prod

# Cloud Run
gcloud run deploy fondation-cli \
  --source . \
  --region us-central1 \
  --allow-unauthenticated
```

## Success Metrics
- Login success rate >95%
- Repository fetch <2s
- Job creation success >90%
- Zero critical errors in production

## Known Limitations (Intentional for v0.1)
- No real-time updates
- No job output display
- No error recovery
- Basic UI without polish
- No caching

## Next Steps
→ Continue to [v0.2 - Execution & Feedback](./v0.2-execution-feedback.md)